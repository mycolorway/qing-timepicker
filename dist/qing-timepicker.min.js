/* qing-timepicker v1.0.2 | (c) Mycolorway Design | MIT License */
!function(t,e){"object"==typeof module&&module.exports?module.exports=e(require("jquery"),require("moment"),require("qing-module")):t.QingTimepicker=e(t.jQuery,t.QingModule)}(this,function(t,e){var i=require=function t(e,i,r){function o(s,p){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!p&&u)return u(s,!0);if(n)return n(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return o(i?i:t)},h,h.exports,t,e,i,r)}return i[s].exports}for(var n="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(i,r,o){var n,s,p=function(t,e){function i(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;s=i("./util.coffee"),n=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return p(i,e),i.opts={wrapper:null,showHour:!0,showMinute:!0,showSecond:!0,placeholder:""},i.prototype._setOptions=function(e){return i.__super__._setOptions.apply(this,arguments),t.extend(this.opts,i.opts,e)},i.prototype._init=function(){return this.wrapper=t(this.opts.wrapper),this.active=!1,this._render(),this.opts.showHour&&this._renderItem("hour"),this.opts.showMinute&&this._renderItem("minute"),this.opts.showSecond&&this._renderItem("second"),this._bind()},i.prototype._render=function(){return this.el=t('<div class="input" tabindex="0" role="input"></div>'),this.el.append("<span class='placeholder'>"+this.opts.placeholder+"</span>"),this.timeWrapper=t('<ul class="time-wrapper"></ul>').appendTo(this.el),this.el.appendTo(this.wrapper)},i.prototype._renderItem=function(e){return t('<li><span class="value"></span></li>').attr("data-type",e).appendTo(this.timeWrapper),t('<li class="divider">:</li>').appendTo(this.timeWrapper)},i.prototype._bind=function(){return this.el.on("click",function(t){return function(e){return t.setActive(!t.active)}}(this)),this.el.on("keydown",function(t){return function(e){if(~[s.ENTER_KEY,s.ARROW_UP_KEY,s.ARROW_DOWN_KEY].indexOf(e.keyCode)&&t.setActive(!0),s.ESCAPE_KEY===e.keyCode&&t.active)return t.setActive(!1)}}(this))},i.prototype.setValue=function(t){return t?(["hour","minute","second"].forEach(function(e){return function(i){return e._setItemValue(i,t)}}(this)),this.el.addClass("selected")):this.el.removeClass("selected")},i.prototype._setItemValue=function(t,e){return this.timeWrapper.find("[data-type='"+t+"'] .value").text(s.parseTimeItem(e[t]()))},i.prototype.setActive=function(t){if(t!==this.active)return this.active=t,this.active?(this.el.addClass("active"),this.trigger("focus")):(this.el.removeClass("active").blur(),this.trigger("blur")),this},i.prototype.highlight=function(t){return this.removeHighlight(),this.timeWrapper.find("[data-type='"+t+"'] .value").addClass("highlighted")},i.prototype.removeHighlight=function(){return this.timeWrapper.find(".value.highlighted").removeClass("highlighted")},i.prototype.destroy=function(){return this.el.remove()},i}(e),r.exports=n},{"./util.coffee":4}],2:[function(i,r,o){var n,s,p=function(t,e){return function(){return t.apply(e,arguments)}},u=function(t,e){function i(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},c={}.hasOwnProperty;s=i("./select-view.coffee"),n=function(e){function i(){return this.setTime=p(this.setTime,this),i.__super__.constructor.apply(this,arguments)}return u(i,e),i.opts={appendTo:null,showHour:!0,showMinute:!0,showSecond:!0},i.prototype._setOptions=function(e){return i.__super__._setOptions.apply(this,arguments),t.extend(this.opts,i.opts,e)},i.prototype._init=function(){return this.active=!1,this.selectors=[],this.time=moment(),this._render(),this._initChildComponents(),this._bind()},i.prototype._render=function(){return this.el=t('<div class="qing-timepicker-popover"></div>')},i.prototype._initChildComponents=function(){if(this.opts.showHour&&this._initSelectView("hour"),this.opts.showMinute&&this._initSelectView("minute"),this.opts.showSecond)return this._initSelectView("second")},i.prototype._initSelectView=function(t){return this.selectors.push(new s({wrapper:this.el,type:t}))},i.prototype._bind=function(){return this.selectors.forEach(function(t){return function(e){return e.on("hover",function(e,i){return t.trigger("hover",[i])}).on("select",function(e,i,r){if(t.time[i](r),t.trigger("select",t.time),i===t.selectors[t.selectors.length-1].type)return t.setActive(!1)})}}(this)),this.el.on("mouseout",function(t){return function(e){return t.trigger("mouseout"),e.stopImmediatePropagation()}}(this))},i.prototype.setTime=function(t){if(t&&(!this.time||!this.time.isSame(t)))return this.time=t,this.selectors.forEach(function(t){return function(e){return e.select(t.time[e.type]())}}(this))},i.prototype.setActive=function(t){if(t!==this.active)return this.active=t,this.active?(this.el.addClass("active").appendTo(this.opts.appendTo),this.trigger("show"),this.selectors.forEach(function(t){return t.scrollToSelected()})):(this.el.removeClass("active").detach(),this.trigger("hide")),this},i.prototype.setPosition=function(t){return this.el.css({top:t.top,left:t.left||0})},i.prototype.destroy=function(){return this.el.remove()},i}(e),r.exports=n},{"./select-view.coffee":3}],3:[function(i,r,o){var n,s,p=function(t,e){function i(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},u={}.hasOwnProperty;s=i("./util.coffee"),n=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return p(i,e),i.opts={wrapper:null,type:"hour"},i.prototype._setOptions=function(e){return i.__super__._setOptions.apply(this,arguments),t.extend(this.opts,i.opts,e)},i.prototype._init=function(){return this.wrapper=t(this.opts.wrapper),this.type=this.opts.type,this.items=this._generateItems(),this._render(),this._renderList(),this._bind()},i.prototype._render=function(){return this.el=t('<div class="select-view"></div>').appendTo(this.wrapper)},i.prototype._renderList=function(){return this.list=t("<ul></ul>"),this.list.append(this.items.map(function(t,e){return"<li>"+t+"</li>"})),this.list.appendTo(this.el)},i.prototype._bind=function(){return this.list.on("mouseover","li",function(t){return function(e){return t.trigger("hover",[t.type]),e.stopImmediatePropagation()}}(this)).on("click","li",function(e){return function(i){var r;return r=parseInt(t(i.currentTarget).text(),10),e.select(r),e.trigger("select",[e.type,r]),e.scrollToSelected(120)}}(this))},i.prototype._generateItems=function(){var t,e;return t="hour"===this.type?24:60,function(){e=[];for(var i=0;0<=t?i<t:i>t;0<=t?i++:i--)e.push(i);return e}.apply(this).map(function(t){return function(t){return s.parseTimeItem(t)}}(this))},i.prototype.select=function(e){if(e=s.parseTimeItem(e),this.selectedValue!==e)return this.selectedValue=e,this.selectedItem=this.list.find("li").get(this.items.indexOf(e)),this.list.find("li.selected").removeClass("selected"),t(this.selectedItem).addClass("selected")},i.prototype.scrollToSelected=function(t){if(this.selectedItem)return this._scrollTo(this.el[0],this.selectedItem.offsetTop,t)},i.prototype._scrollTo=function(t,e,i){var r;return null==i&&(i=0),i<=0?t.scrollTop=e:(r=(e-t.scrollTop)/i*10,window.requestAnimationFrame(function(o){return function(){if(t.scrollTop=t.scrollTop+r,t.scrollTop!==e)return o._scrollTo(t,e,i-10)}}(this)))},i}(e),r.exports=n},{"./util.coffee":4}],4:[function(t,e,i){var r,o,n,s;s=function(t,e){return"string"==typeof t?moment(t,e):"[object Date]"===Object.prototype.toString.call(t)?moment(t):moment.isMoment(t)?t.clone():void 0},o=function(t,e){var i;return e="string"==typeof e?e:null,i=s(t,e),i&&i.isValid()?i:null},n=function(t){return t="string"==typeof t?parseInt(t,10):t,t<10?"0"+t:t.toString()},r={parseDate:o,parseTimeItem:n,ENTER_KEY:13,ARROW_DOWN_KEY:40,ARROW_UP_KEY:38,ESCAPE_KEY:27},e.exports=r},{}],"qing-timepicker":[function(i,r,o){var n,s,p,u,c,h=function(t,e){function i(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},l={}.hasOwnProperty;n=i("./input.coffee"),s=i("./popover.coffee"),c=i("./util.coffee"),p=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}return h(i,e),i.name="QingTimepicker",i.opts={el:null,format:"HH:mm:ss",renderer:null,appendTo:null},i.count=0,i.prototype._setOptions=function(e){return i.__super__._setOptions.apply(this,arguments),t.extend(this.opts,i.opts,e)},i.prototype._init=function(){var e;if(this.el=t(this.opts.el),!(this.el.length>0))throw new Error("QingTimepicker: option el is required");return(e=this.el.data("qingTimepicker"))?e:(this.id=++i.count,this._render(),this._renderChildComponents(),this._bind(),t.isFunction(this.opts.renderer)&&this.opts.renderer.call(this,this.wrapper,this),this.setTime(this.el.val()))},i.prototype._render=function(){return this.wrapper=t('<div class="qing-timepicker"></div>').data("qingTimepicker",this).insertBefore(this.el).append(this.el),this.clearButton=t('<a href="javascript:;" class="clear-button">&times;</a>').attr("tabindex",-1).appendTo(this.wrapper),this.el.hide().data("qingTimepicker",this)},i.prototype._renderChildComponents=function(){var e;return e=u(this.opts.format),this.input=new n(t.extend({wrapper:this.wrapper,placeholder:this.opts.placeholder||this.el.attr("placeholder")||""},e)),this.popover=new s(t.extend({appendTo:this.opts.appendTo||this.wrapper},e))},i.prototype._bind=function(){return t(document).on("click.qing-timepicker-"+this.id,function(e){return function(i){if(!t.contains(e.wrapper[0],i.target)&&!t.contains(e.popover.el[0],i.target))return e.popover.setActive(!1),null}}(this)),this.input.on("focus",function(t){return function(){var e;return t.popover.setTime((null!=(e=t.time)?e.clone():void 0)||moment()),t.popover.setActive(!0)}}(this)).on("blur",function(t){return function(){return t.popover.setActive(!1)}}(this)),this.clearButton.on("click",function(t){return function(){return t.popover.active&&t.popover.setActive(!1),t.clear()}}(this)),this.popover.on("show",function(t){return function(){return t._updatePopoverPosition()}}(this)).on("hide",function(t){return function(){return t.input.setActive(!1),t.input.removeHighlight()}}(this)).on("hover",function(t){return function(e,i){if(t.time)return t.input.highlight(i)}}(this)).on("mouseout",function(t){return function(){return t.input.removeHighlight()}}(this)).on("select",function(t){return function(e,i){return t.setTime(i)}}(this))},i.prototype._updatePopoverPosition=function(){var t,e;return this.opts.appendTo?(e=this.wrapper.position(),t={top:e.top+this.input.el.outerHeight()+6,left:e.left}):t={top:this.input.el.outerHeight()+6},this.popover.setPosition(t)},i.prototype.setTime=function(t){var e,i;if(i=c.parseDate(t,this.opts.format),i&&!i.isSame(this.time))return e=i.format(this.opts.format),this.time=i,this.input.setValue(this.time),this.el.val(e),this.clearButton.addClass("active"),this.trigger("change",[e])},i.prototype.getTime=function(){var t;return null!=(t=this.time)?t.format(this.opts.format):void 0},i.prototype.clear=function(){return this.time=null,this.input.setValue(this.time),this.el.val(""),this.trigger("change",[""]),this.clearButton.removeClass("active")},i.prototype.destroy=function(){var e;return this.el.insertAfter(this.wrapper).show().removeData("qingTimepicker"),null!=(e=this.popover)&&e.destroy(),this.wrapper.remove(),t(document).off(".qing-timepicker-"+this.id)},i}(e),u=function(t){var e;switch(e={},t){case"HH:mm:ss":e.showHour=e.showMinute=e.showSecond=!0;break;case"HH:mm":e.showHour=e.showMinute=!0,e.showSecond=!1;break;case"mm:ss":e.showHour=!1,e.showMinute=e.showSecond=!0}return e},r.exports=p},{"./input.coffee":1,"./popover.coffee":2,"./util.coffee":4}]},{},[]);return i("qing-timepicker")});